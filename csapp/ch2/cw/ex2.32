This function will give correct values, except when y is TMin.
